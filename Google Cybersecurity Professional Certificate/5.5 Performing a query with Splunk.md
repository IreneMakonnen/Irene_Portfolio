# Performing a query with Splunk

## Scenario

You are a security analyst working at the e-commerce store Buttercup Games. You've been tasked with identifying whether there are any possible security issues with the mail server. To do so, you must explore any failed SSH logins for the root account.  

Uploaded to Splunk is the data that contains log and event information from Buttercup Games' mail servers and web accounts. This includes information like access and authentication logs, email logs, and more.

### Performing a basic search
To confirm that the data has been ingested, indexed, and is searchable, a query is input. <br>
In the search bar, index="main" is entered as a search query. This search term specifies the index. An **index** is a repository for data. Here, the index is a single dataset containing events from an index named main. **All Time** from the time range dropdown is selected to search for all the events across all time.

![Image](https://github.com/user-attachments/assets/cd9b57f3-c3ea-41fb-914e-5c9dcc9a8130)

### Evaluating fields
When Splunk indexes data, it attaches fields to each event. These fields become part of the searchable index event data. This helps security analysts easily search for and find the specific data they need. For each event the fields are host, source, and sourcetype.

To examine the field values, the field under **SELECTED FIELDS** is clicked. You should observe the following:

- **host**: The host field specifies the name of the network host from which the event originated. 
In this search there are five hosts: <br>
    - mailsv - Buttercup Games' mail server. Examine events generated from this host.<br>
    - www1 - This is one of Buttercup Games' web applications.<br>
    - www2 - This is one of Buttercup Games' web applications.<br>
    - www3 - This is one of Buttercup Games' web applications.<br>
    - vendor_sales - Information about Buttercup Games' retail sales.

![Image](https://github.com/user-attachments/assets/3f18ab6f-16bc-493a-a380-e4a9252df13f)

        
- **source**: The source field indicates the file name from which the event originates. You should identify eight sources. Notice /mailsv/secure.log, which is a log file that contains information related to authentication and authorization attempts on the mail server.

![Image](https://github.com/user-attachments/assets/6dd55ebd-0add-48fe-a4ed-cfc1cf46c266)
    
- **sourcetype**: The sourcetype determines how data is formatted. You should observe three sourcetypes.

![Image](https://github.com/user-attachments/assets/90fe3fb7-d1fe-4119-813d-dc29612d92f3)

An example of a sourcetype, secure-2.

![Image](https://github.com/user-attachments/assets/670cf619-a2f9-42dd-b4c9-986a4511cd33)

### Narrowing a search
Because we're exploring any failed SSH logins for the root account on the mail server, we'll need to narrow the search results for events from the mail server.

When **mailsv** is selected under **host** in **SELECTED FIELDS**, a new term is added to the search bar: index=main host=mailsv. The search results have narrowed to over 9000 events that are generated by the mail server.

![Image](https://github.com/user-attachments/assets/a57fb0c5-0477-4196-92d7-9b3e760e6365)

### Searching for failed login for root
The search is narrowed to locate any failed SSH logins for the root account. 
In the search bar index=main host=mailsv fail* root is entered. 
This search expands on the search from the previous task and searches for the keyword fail*. The wildcard tells Splunk to expand the search term to find other terms that contain the word _fail_ such as _failure_, _failed_, etc. Lastly, the keyword root searches for any event that contains the term root.

![Image](https://github.com/user-attachments/assets/29b47cdd-ffd3-4076-a637-8c71b98e1573)

This search retrieves over 300 events.
